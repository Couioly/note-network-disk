
HTTP请求的生命周期：**指从用户在浏览器中输入URL开始，到页面完全加载并显示出来为止，中间发生的所有步骤**。大体分为两大阶段：

- **前端阶段**：发生在客户端（通常为浏览器）和应用基础设施上的操作
- **后端阶段**：发生在服务器端，涉及应用程序逻辑、数据库等

---

## 前端阶段

### Step1 URL 解析

**操作**：用户在浏览器地址栏输入 `https://www.example.com/page` 并按下回车。
**处理过程**：浏览器对输入的URL进行解析，判断是否合法：
- **不合法**：浏览器会使用默认的搜索引擎进行搜索（例如搜索URL为某个关键字）；
- **合法**：浏览器对URL进行解析以划分出协议、主机名、端口、路径等信息。

```url
以https://www.example.com/page为例：
解析后的信息为：
协议：https
主机名：www.example.com
端口：不指定时使用默认值443/80（https默认443，http默认80）
路径：/page
```

### Step2 DNS 查询

**操作**：将人类可读的主机名（域名）转换为计算机可读的IP地址。
**处理过程**：进行一个递归查询：
- **浏览器缓存**：浏览器首先检查自己的缓存中是否存有这个域名的IP地址；
- **操作系统缓存**：若浏览器缓存不存在，则它将查询操作系统的**hosts文件**和**DNS解析器**缓存；
- **路由器缓存**：查询本地网络的路由器；
- **ISP DNS服务器**：若以上查询都不存在该IP，请求会发送至互联网服务提供商（ISP）的DNS服务器（ISP的DNS递归解析器），这是最常见的查询起点；
- **递归查询**：ISP的DNS服务器会从DNS根域名服务器开始，依次查询顶级域（TLD）服务器，最后查询权威名称服务器，获取到最终的IP地址；一旦找到IP，它将被缓存起来，以备后续使用。

>[!tips] 用自己的话说
>所以说，浏览器（客户端）只是发布了一个**递归查询**指定域名IP的任务，要求获得结果，倘若通过**浏览器、操作系统和路由器的缓存查询**后仍未找到该域名的IP，会将“递归查询”的任务委托给**ISP的DNS递归解析器**，ISP的DNS递归解析器将在全球DNS系统中按照“根域名服务器->顶级域服务器->权威名称服务器”的顺序进行**迭代查询**，最终返回结果！

>[!faq] 浏览器的IP存储我们是否可以查询到？
>以Chorme浏览器为例：
>- `chrome://net-internals/#dns`：该内部页面可以查询浏览器缓存的IP地址，你可以手动点击 `Clear host cache` 来清空它；
>- `chrome://settings/clearBrowserData`：可以快速跳转到清除浏览数据的设置页面。


