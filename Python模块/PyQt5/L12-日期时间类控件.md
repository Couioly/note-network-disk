日期时间类控件主要是对日期、时间等信息进行编辑、选择或者显示，在PyQt5中提供了`Date/TimeEdit`、`DateEdit`、`TimeEdit`和`CalendarWidget`等4个相关的控件，本节将对它们的常用方法和使用方式进行讲解。

## 1  日期和时间控件
---

PyQt5中提供了3个日期时间控件，分别是`Date/TimeEdit`控件、`DateEdit`控件和`TimeEdit`控件，其中，`Date/TimeEdit`控件对应的类是`QDateTimeEdit`，该控件可以**同时显示和编辑日期时间**；`DateEdit`控件对应的类是`QDateEdit`，它是`QDateTimeEdit`的子类，**只能显示和编辑日期**；`TimeEdit`控件对应的类是`QTimeEdit`，它是`QDateTimeEdit`的子类，**只能显示和编辑时间**。

`QDateTimeEdit`类的常用方法及说明如表所示。

| **方    法**         | **说    明**                                                                                                                                                                                                                                                                                                 |
| ------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| setTime()          | 设置时间，默认为0:00:00                                                                                                                                                                                                                                                                                            |
| setMaximumTime()   | 设置最大时间，默认为23:59:59                                                                                                                                                                                                                                                                                         |
| setMinimumTime()   | 设置最小时间，默认为0:00:00                                                                                                                                                                                                                                                                                          |
| setTimeSpec()      | 获取显示的时间标准，支持以下4种取值：<br><br>◆ LocalTime：本地时间<br><br>◆ UTC：世界标准时间<br><br>◆ OffsetFromUTC：与UTC等效的时间<br><br>◆ TimeZone：时区                                                                                                                                                                                      |
| setDateTime()      | 设置日期时间，默认为2000/1/1 0:00:00                                                                                                                                                                                                                                                                                 |
| setDate()          | 设置日期，默认为2000/1/1                                                                                                                                                                                                                                                                                           |
| setMaximumDate()   | 设置最大日期，默认为9999/12/31                                                                                                                                                                                                                                                                                       |
| setMinimumDate()   | 设置最小日期，默认为1752/9/14                                                                                                                                                                                                                                                                                        |
| setDisplayFormat() | 设置日期时间显示样式，常见形式如下：<br><br>◆ 日期样式（yyyy表示4位数年份；MM表示2位数月份，dd表示2位数日）：<br><br>■  yyyy/MM/dd<br><br>■  yyyy/M/d<br><br>■  yy/MM/dd<br><br>■  yy/M/d<br><br>■  yy/MM<br><br>■  Mm/dd<br><br>◆ 时间样式（HH表示2位数小时；mm表示2位数分钟，ss表示2位数秒钟）：<br><br>■  HH:mm:ss<br><br>■  HH:mm<br><br>■  mm:ss<br><br>■  H:m<br><br>■  m:s |
| date()             | 获取显示的日期，返回值为QDate类型，例如QDate(2000,1,1)                                                                                                                                                                                                                                                                      |
| time()             | 获取显示的时间，返回值为QTime类型，例如QTime(0,0)                                                                                                                                                                                                                                                                           |
| dateTime()         | 获取显示的日期时间，返回值为QDateTime类型，例如QDateTime(2000, 1, 1, 0, 0)                                                                                                                                                                                                                                                    |

>[!info] 说明
>由于`QDateEdit`和`QTimeEdit`类都是从`QDateTimeEdit`类继承而来的，因此它们都拥有`QDateTimeEdit`类的所有公共方法。

QDateTimeEdit类的常用信号及说明如表所示。

| **信    号**      | **说    明**    |
| --------------- | ------------- |
| timeChanged     | 时间发生改变时发射     |
| dateChanged     | 日期发生改变时发射     |
| dateTimeChanged | 日期或者时间发生改变时发射 |

例如，在Qt Designer设计器的窗口中分别添加一个`Date/TimeEdit`控件、一个`DateEdit`控件和一个`TimeEdit`控件，它们的显示效果如图所示。

![[Pasted image 20250901201046.png]]

>[!tip] 多学两招
1）由于`date()`、`time()`和`dateTime()`方法的返回值分别是`QDate`类型、`QTime`类型和`QDateTime`类型，无法直接使用，因此如果想要获取日期时间控件中的具体日期和（或）时间值，可以使用`text()`方法进行获取，例如：
>```python
self.dateTimeEdit.text()
>```
2）使用日期时间控件时，如果要改变日期时间，默认只能通过上下箭头来改变，如果想弹出日历控件，那么设置`setCalendarPoput(True)`即可。

## 2  `CalendarWidget`：日历控件
---

`CalendarWidget`控件，又称为日历控件，主要用来显示和选择日期。

`CalendarWidget`控件对应PyQt5中的`QCalendarWidget`类，该类的常用方法及说明如表所示。

| **方    法**                | **说    明**                                                                                                                                                                                                                   |
| ------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| setSelectedDate()         | 设置选中的日期，默认为当前日期                                                                                                                                                                                                              |
| setMinimumDate()          | 设置最小日期，默认为1752/9/14                                                                                                                                                                                                          |
| setMaximumDate            | 设置最大日期，默认为9999/12/31                                                                                                                                                                                                         |
| setFirstDayOfWeek         | 设置一周的第一天，取值如下：<br><br>◆ Qt.Monday：星期一<br><br>◆ Qt.Tuesday：星期二<br><br>◆ Qt.Wednesday：星期三<br><br>◆ Qt.Thursday：星期四<br><br>◆ Qt.Friday：星期五<br><br>◆ Qt.Saturday：星期六<br><br>◆ Qt.Sunday：星期日                                      |
| setGridVisible            | 设置是否显示网格线                                                                                                                                                                                                                    |
| setSelectionMode          | 设置选择模式，取值如下：<br><br>◆ QCalendarWidget.NoSelection：不能选中日期<br><br>◆ QCalendarWidget.SingleSelection：可以选中一个日期                                                                                                                   |
| setHorizontalHeaderFormat | 设置水平头部格式，分别如下：<br><br>◆ QCalendarWidget.NoHorizontalHeader：不显示水平头部<br><br>◆ QCalendarWidget.SingleLetterDayNames：“周”<br><br>◆ QCalendarWidget.ShortDayNames：简短天的名称，如“周一”<br><br>◆ QCalendarWidget.LongDayNames：完整天的名称，如“星期一” |
| setVerticalHeaderFormat   | 设置对齐方式，有水平和垂直两种，分别如下：<br><br>◆ QCalendarWidget.NoVerticalHeader：不显示垂直头部<br><br>◆ QCalendarWidget.ISOWeekNumbers：以星期数字显示垂直头部                                                                                                  |
| setNavigationBarVisible   | 设置是否显示导航栏                                                                                                                                                                                                                    |
| setDateEditEnabled        | 设置是否可以编辑日期                                                                                                                                                                                                                   |
| setDateEditAcceptDelay()  | 设置编辑日期的最长间隔，默认为1500                                                                                                                                                                                                          |
| selectedDate()            | 获取选择的日期，返回值而QDate类型                                                                                                                                                                                                          |

`CalendarWidget`控件最常用的信号是`selectionChanged`，该信号在选择的日期发生改变时发射。

**实例 获取选中的日期**

在Qt Designer设计器中创建一个窗口，在窗口中添加一个`CalendarWidget`控件，设计完成后保存为`.ui`文件，并使用Pyuic工具将其转换为`.py`代码文件。在`.py`代码文件中自定义一个`getdate()方法`，用来获取`CalendarWidget`控件中选中的日期，并转换为`年-月-日`形式，显示在弹出的提示框中，代码如下：

```python
def getdate(self):  
    from PyQt5.QtWidgets import QMessageBox  
    # 获取当前选中日期的QDate对象  
    date = QtCore.QDate(self.calendarWidget.selectedDate())  
    year = date.year()    # 获取年份  
    month = date.month()  # 获取月份  
    day = date.day()      # 获取日  
    QMessageBox.information(MainWindow, "提示", str(year) + "-" + str(month) + "-" + str(day), QMessageBox.Ok)
```

对`CalendarWidget`控件进行设置，并为其`selectionChanged信号`绑定自定义的`getdate()槽函数`，代码如下：

```python
self.calendarWidget = QtWidgets.QCalendarWidget(self.centralwidget)  
self.calendarWidget.setGeometry(QtCore.QRect(20, 10, 248, 197))  
self.calendarWidget.setSelectedDate(QtCore.QDate(2020, 3, 23))  # 设置默认选中的日期  
self.calendarWidget.setMinimumDate(QtCore.QDate(1752, 9, 14))  # 设置最小的日期  
self.calendarWidget.setMaximumDate(QtCore.QDate(9999, 12, 31))  # 设置最大的日期  
self.calendarWidget.setFirstDayOfWeek(QtCore.Qt.Monday)  # 设置每周的第一天为星期一  
self.calendarWidget.setGridVisible(True)  # 设置网格线可见  
# 设置可以选中单个日期  
self.calendarWidget.setSelectionMode(QtWidgets.QCalendarWidget.SingleSelection)  
# 设置水平表头为简短形式，即“周一”形式  
self.calendarWidget.setHorizontalHeaderFormat(QtWidgets.QCalendarWidget.ShortDayNames)  
# 设置垂直表头为周数  
self.calendarWidget.setVerticalHeaderFormat(QtWidgets.QCalendarWidget.ISOWeekNumbers)  
self.calendarWidget.setNavigationBarVisible(True)  # 设置显示导航栏  
self.calendarWidget.setDateEditEnabled(True)  # 设置日期可以编辑  
self.calendarWidget.setObjectName("calendarWidget")  
# 选中日期变化时显示选择的日期  
self.calendarWidget.selectionChanged.connect(self.getdate)
```

为`.py`文件添加程序入口，然后运行程序，日期控件在窗口中的显示效果如图所示;

![[Pasted image 20250901202415.png]]

单击某个日期时，可以弹出对话框进行显示，如图所示。

![[Pasted image 20250901202613.png]]

>[!tip] 多学两招
>在PyQt5中，如果要**获取当前系统的日期时间**，可以借助`QtCore`模块下的`QDateTime`类、`QDate`类或者`QTime`类实现。其中，**获取当前系统的日期时间**可以使用`QDateTime`类的`currentDateTime()方法`，**获取当前系统的日期**可以使用`QDate`类的`currentDate()方法`，**获取当前系统的时间**可以使用`QTime`类的`currentTime()方法`，代码如下：
>```
># 获取当前系统的日期时间  
>datetime = QtCore.QDateTime.currentDateTime()  
># 获取当前系统的日期  
>date = QtCore.QDate.currentDate()  
># 获取当前系统的时间  
>time = QtCore.QTime.currentTime()
>```

